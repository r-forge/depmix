setClass("MULTINOMresponse",contains="GLMresponse")setMethod("fit","MULTINOMresponse",	function(object,w) {		pars <- object@parameters		base <- object@family$base # delete me		#y <- object@y[,-base]		x <- object@x		mask <- matrix(1,nrow=nrow(pars$coefficients),ncol=ncol(pars$coefficients))		mask[,base] <- 0 # fix base category coefficients to 0		mask <- rbind(0,mask) # fix "bias" nodes to 0		Wts <- mask		Wts[-1,] <- t(pars$coefficients) # set starting weights		fit <- nnet.default(x,y,weights=w,size=0,entropy=TRUE,skip=TRUE,mask=mask,Wts=Wts,trace=FALSE)		pars$coefficients <- matrix(fit$wts,ncol=ncol(pars$coefficients),nrow=nrow(pars$coefficients)+1,byrow=TRUE)[-1,]		object <- setpars(object,unlist(pars))		object	})setMethod("logDens","MULTINOMresponse",	function(object) {		log(rowSums(object@y*predict(object)))	})setMethod("dens","MULTINOMresponse",	function(object,log=FALSE) {		if(log) log(rowSums(object@y*predict(object)))		else rowSums(object@y*predict(object))	})setMethod("predict","MULTINOMresponse",	function(object) {		if(object@family$link=="identity") object@x%*%object@parameters$coefficients		else {			object@family$linkinv(object@x%*%object@parameters$coefficients,base=object@family$base)		}	})