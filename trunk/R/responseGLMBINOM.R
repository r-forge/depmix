setClass("BINOMresponse",representation(n="matrix"),contains="GLMresponse")# method 'fit'# use: in EM (M step)# returns: (fitted) response with (new) estimates of parameters# methods 'logDens' & dens# use: instead of density slot in rModel# returns: matrix with log(p(y|x,parameters))setMethod("logDens","BINOMresponse",	function(object) {		dbinom(x=object@y,size=object@n,prob=predict(object),log=TRUE)	})setMethod("dens","BINOMresponse",	function(object,log=FALSE) {		dbinom(x=object@y,size=object@n,prob=predict(object),log=log)	})setMethod("simulate",signature(object="BINOMresponse"),  function(object,nsim=1,seed=NULL,time) {    if(missing(time)) {      # draw in one go      pr <- predict(object)    } else {      pr <- predict(object)[time,]    }      nt <- nrow(pr)    response <- rbinom(nt*nsim,size=object@n,prob=pr)    #if(nsim > 1) response <- matrix(response,ncol=nsim)    response <- as.matrix(response)    return(response)  })