setClass("NORMresponse",contains="GLMresponse")# method 'fit'# use: in EM (M step)# returns: (fitted) response with (new) estimates of parameterssetMethod("fit","NORMresponse",	function(object,w) {		pars <- object@parameters		fit <- lm.wfit(x=object@x,y=object@y,w=w)		pars$coefficients <- fit$coefficients		pars$sd <- sqrt(sum(w*fit$residuals^2/sum(w)))		object <- setpars(object,unlist(pars))		object	})setMethod("logDens","NORMresponse",	function(object) {		dnorm(x=object@y,mean=predict(object),sd=object@parameters$sd,log=TRUE)	})setMethod("dens","NORMresponse",	function(object,log=FALSE) {		dnorm(x=object@y,mean=predict(object),sd=object@parameters$sd,log=log)	})setMethod("predict","NORMresponse",	function(object) {		object@x%*%object@parameters$coefficients	})setMethod("simulate",signature(object="NORMresponse"),  function(object,nsim=1,seed=NULL,time) {    if(missing(time)) {      # draw in one go      mu <- predict(object)    } else {      mu <- predict(object)[time]    }      nt <- length(mu)    sd <- getpars(object)["sd"]    response <- rnorm(nt*nsim,mean=mu,sd=sd)    if(nsim > 1) response <- matrix(response,ncol=nsim)    return(response)  })